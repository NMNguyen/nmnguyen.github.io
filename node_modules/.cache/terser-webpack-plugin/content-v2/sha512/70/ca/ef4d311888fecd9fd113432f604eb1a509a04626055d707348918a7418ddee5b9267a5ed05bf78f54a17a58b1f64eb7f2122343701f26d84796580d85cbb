{"code":"(window[\"webpackJsonp\"]=window[\"webpackJsonp\"]||[]).push([[\"chunk-893eb946\"],{\"8ba2\":function(e,t,a){},bed3:function(e,t,a){\"use strict\";a.r(t);var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a(\"div\",{staticClass:\"content\"},[a(\"h1\",[e._v(e._s(e.messages.SR_001_USER_PROFILE))]),a(\"p\",[e._v(e._s(e.messages.SR_001_USER_PROFILE_DESCR))]),a(\"div\",{staticClass:\"my-3\"},[a(\"img\",{staticClass:\"logo\",attrs:{src:e.photoURL,alt:\"User Avatar\",onerror:\"this.style.opacity='0'\"}})]),a(\"label\",{staticClass:\"uploadPicture\",attrs:{for:\"file_input\"}},[a(\"i\",{staticClass:\"fa fa-plus\"},[e._v(\" \")]),e._v(e._s(e.messages.SR_001_UPLOAD_BUTTON)+\"\\n    \")]),a(\"input\",{staticStyle:{display:\"none\"},attrs:{id:\"file_input\",type:\"file\",accept:\"image/*\"},on:{change:function(t){return e.detectFiles(t.target.files)}}}),a(\"div\",{staticClass:\"my-3\"},[a(\"div\",[a(\"input\",{directives:[{name:\"model\",rawName:\"v-model\",value:e.name,expression:\"name\"}],staticStyle:{width:\"320px\"},attrs:{type:\"text\",name:\"user_name\",id:\"user_name\",placeholder:e.messages.COMMON_USER_DISPLAY_NAME},domProps:{value:e.name},on:{input:function(t){t.target.composing||(e.name=t.target.value)}}}),e.error?a(\"span\",{staticStyle:{color:\"red\",\"padding-left\":\"10px\"}},[e._v(\" \"+e._s(e.errorMessage))]):e._e()]),a(\"button\",{staticClass:\"my-3 btn btn-blue default\",on:{click:e.SaveUser}},[e.saveflag?e._e():a(\"i\",{staticClass:\"default fa fa-save\"},[e._v(\"  \")]),e.saveflag?e._e():a(\"span\",{staticClass:\"default\"},[e._v(e._s(e.messages.COMMON_SAVE))]),e.saveflag?a(\"i\",{staticClass:\"success fa fa-check\"},[e._v(\"  \")]):e._e(),e.saveflag?a(\"span\",{staticClass:\"success\"},[e._v(e._s(e.messages.COMMON_SAVED))]):e._e()])])])},r=[],n=(a(\"7f7f\"),a(\"cebc\")),o=a(\"2b0e\"),i=a(\"dd81\"),l=a(\"2f62\"),c=o[\"default\"].extend({name:\"UserProfile\",data:function(){return{email:\"\",username:\"\",name:\"\",saveflag:!1,whichFile:\"\",upload:{},photoURL:\"\",filename:\"\",fileupload:{},flag_upload:!1,errorMessage:\"\",error:!1}},computed:Object(n[\"a\"])({},Object(l[\"c\"])([\"currentUser\",\"currentCompany\"])),watch:{currentUser:function(e){var t=this;t.name=e.name,t.photoURL=e.photoURL}},mounted:function(){var e=this;e.currentUser&&(e.name=e.currentUser.name,e.currentUser.photoURL&&(e.photoURL=e.currentUser.photoURL))},methods:{validate:function(){var e=this,t=!0;return e.error=!1,e.errorMessage=\"\",e.name=e.name.trim(),\"\"==e.name&&(e.errorMessage=\"Tên người dùng không được để trống !\",t=!1,e.error=!0),t},SaveUser:function(){var e=this,t=this;if(t.currentUser&&t.validate()){if(t.currentUser.name=t.name,t.flag_upload){t.$toasted.show(t.messages.SR_001_UPLOADING);var a=t.currentUser.email+\"-\"+t.stringGen(10)+t.currentUser.id+\"-\"+t.filename;t.upload=i[\"d\"].ref(\"image/avatar/\"+t.currentUser.id+\"/\"+a).put(t.fileupload),t.upload.on(\"state_changed\",function(a){a.bytesTransferred==a.totalBytes&&e.$toasted.show(t.messages.SR_001_UPLOADED)},null,function(){t.upload.snapshot.ref.getDownloadURL().then(function(e){var s=t.currentUser.photoName;if(t.currentUser.photoURL=e,t.currentUser.photoName=a,console.log(e),t.currentUser.update(),s&&\"\"!=s){var r=i[\"d\"].ref().child(\"image/avatar/\"+t.currentUser.id+\"/\"+s);r.delete().then(function(){}).catch(function(e){console.log(e)})}})})}t.currentUser.update(),t.saveflag=!0,setTimeout(function(){t.saveflag=!1},2e3)}},createImage:function(e){var t=new FileReader,a=this;a.filename=e.name,t.onload=function(e){a.photoURL=t.result},t.readAsDataURL(e)},detectFiles:function(e,t){var a=this;a.flag_upload=!1,a.whichFile=t,console.log(e),1==e.length&&(-1==e[0].type.indexOf(\"image\")?this.$toasted.error(\"Chỉ được up file ảnh !\"):(a.createImage(e[0]),a.fileupload=e[0],a.flag_upload=!0))},stringGen:function(e){for(var t=\" \",a=\"abcdefghijklmnopqrstuvwxyz0123456789\",s=0;s<e;s++)t+=a.charAt(Math.floor(Math.random()*a.length));return t}}}),u=c,f=(a(\"c118\"),a(\"2877\")),d=Object(f[\"a\"])(u,s,r,!1,null,null,null);t[\"default\"]=d.exports},c118:function(e,t,a){\"use strict\";var s=a(\"8ba2\"),r=a.n(s);r.a}}]);","extractedComments":[]}